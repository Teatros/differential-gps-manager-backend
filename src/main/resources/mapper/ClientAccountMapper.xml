<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.firedance.gps.dao.ClientAccountMapper">
    <resultMap id="BaseResultMap" type="com.firedance.gps.model.ClientAccount">
        <id column="id" property="id"/>
        <result column="account" property="account"/>
        <result column="password" property="password"/>
        <result column="specification" property="specification"/>
        <result column="service_start_datetime" property="serviceStartDateTime"/>
        <result column="service_end_datetime" property="serviceEndDateTime"/>
        <result column="last_login_date_time" property="lastLoginDateTime"/>
        <result column="create_date_time" property="createDateTime"/>
        <result column="forbidden" property="forbidden"/>
    </resultMap>
    <sql id="base_sql">
        id,account,password,specification,service_start_datetime,service_end_datetime,last_login_date_time,create_date_time,forbidden
    </sql>
    <select id="selectByAccount" resultMap="BaseResultMap">
        select <include refid="base_sql"/> from client_account
        where account = #{account}
    </select>
    <select id="list" parameterType="com.firedance.gps.controller.param.ClientUserQueryParams" resultMap="BaseResultMap">
        select <include refid="base_sql"/> from client_account
        where
        is_delete = 0
        <if test="account!=null and account!=''">
            and account like concat('%',#{account},'%')
        </if>
        <if test="serviceStartDateTime != null">
            and service_start_datetime <![CDATA[>=]]> #{serviceStartDateTime}
        </if>
        <if test="serviceStartDateTime != null">
            and service_start_datetime <![CDATA[>=]]> #{serviceStartDateTime}
        </if>
    </select>
    <insert id="batchInsert" parameterType="com.firedance.gps.model.ClientAccount">
        insert into client_account(id,account,password,specification,service_start_datetime,service_end_datetime,forbidden,create_date_time,is_delete)
        values
        <foreach collection="clientAccounts" item="clientAccount" separator=",">
            (#{clientAccount.id},#{clientAccount.account},#{clientAccount.password},#{clientAccount.specification},
             #{clientAccount.serviceStartDateTime},#{clientAccount.serviceEndDateTime},#{clientAccount.forbidden},
             NOW(),0)
        </foreach>
    </insert>
    <update id="update" parameterType="com.firedance.gps.model.ClientAccount">
        update client_account
        <set>
            <if test="password != null and password!=''">
                password = #{password},
            </if>
            <if test="specification != null">
                specification = #{specification},
            </if>
            <if test="serviceStartDateTime != null">
                service_start_datetime = #{serviceStartDateTime},
            </if>
            <if test="serviceEndDateTime != null">
                service_end_datetime = #{serviceEndDateTime},
            </if>
            <if test="forbidden != null">
                forbidden = #{forbidden},
            </if>
        </set>
        where
        account=#{account}
    </update>
</mapper>
